1、首先在上线前，需要对历史订单数据进行一次全量分析，计算出几种基本不变的数据：

1、首次购买
2、第二次购买时间
3、最近两年的指标
4、两年前的指标
5、最近一年的指标


然后每天统计是基于增量表，算出有变化的数据，合入上面几个中间表后，在进行数据合并，分别算出三个层级的数据


1、先执行脚本trade-history-base-init.sql 将今天之前的所有订单数据初始化，用于计算上线前的月底数据和前一天数据
2、历史订单数据的分析脚本，history-trade-analyze.sql是基于第一步中初始化的订单计算的。
3、每日订单RFM分析是基于历史计算的前一天的RFM数据进行合并处理的。
4、新增租户的历史数据计算，需要重新增加计算流程，对今日新增订单中的租户和昨天分析的租户取差集，对识别新增的租户从今日新增的订单中分析历史数据。

每日新增数据重新计算历史前13月月底数据：

1、对今日新增数据进行标识，按照时间节点计算出各个月底时间点对应的最早、近一年、近两年、两年前的数据
2、然后和对应月底的已有数据进行合并
